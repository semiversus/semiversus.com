<!DOCTYPE html><html lang=de> <head><title>VHDL Test (1)</title><link rel=icon href=https://www.semiversus.com/favicon.ico><meta charset=utf-8><meta name=description content="Allgemeines Projektordner herunterladen und entpacken Insgesamt gibt es 29 Punkte Die einzelnen Punkte bauen meist nicht aufeinander auf. Statt langer Fehlersuche lieber auf das nächste Beispiel wechseln. Lichtsteuerung Vorbereitung Projekt led_control/led_control.xise öffnen Aufgabenstellung Es ist eine einfache Lichtsteuerung zu entwerfen. Diese Lichtsteuerung steuert eine LED an und ..."><meta name=author content="Günther Jena"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=google-site-verification content=O-3LVEziPiVrCYqFCwbLmB3s7lNG__cPMLLAr_RUxbA><meta name=msvalidate.01 content=70DFF0E672B42811AA384CC455C9406C><link rel=stylesheet href=https://www.semiversus.com/theme/css/semiversus.min.css?f7108c59><script async src=https://www.semiversus.com/theme/js/semiversus.min.js?c02fe949></script></head> <body data-spy=scroll data-target=#sidebar data-offset=30> <div id=wrap> <nav class="navbar navbar-inverse"> <div class=container> <div class=navbar-header> <button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=.navbar-collapse> <span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span> </button> <a href=https://www.semiversus.com/index.html class=navbar-brand>SEMIVERSUS</a> </div> <div class="navbar-collapse collapse"> <ul class="nav navbar-nav"> <li><a href=https://www.semiversus.com/index.html>Blog</a></li> <li><a href=https://www.semiversus.com/dic/uebersicht.html>Unterricht</a></li> <li><a href=https://www.semiversus.com/projekte/projekte.html>Projekte</a></li> <li><a href=https://www.semiversus.com/about.html>Über mich</a></li> </ul> <form class="navbar-form navbar-right" role=search action=https://www.semiversus.com/search.html onsubmit="return validateForm(this.elements['q'].value);"> <input type=text class=form-control placeholder=Suche name=q id=tipue_search_input></form> <ul class="nav navbar-nav navbar-right socialicons"> <li><a href=https://www.linkedin.com/in/guenther-jena data-toggle=tooltip data-placement=bottom title=LinkedIn.com/Günther-Jena><span class="linkedin icon hidden-xs"></span><span class="hidden-sm hidden-md hidden-lg">Linkedin</span></a></li> <li><a href=https://www.xing.com/profile/Guenther_Jena2 data-toggle=tooltip data-placement=bottom title=Xing.com/Günther-Jena><span class="xing icon hidden-xs"></span><span class="hidden-sm hidden-md hidden-lg">Xing</span></a></li> <li><a href=https://stackoverflow.com/users/166605/g%C3%BCnther-jena data-toggle=tooltip data-placement=bottom title=Stackoverflow.com/Semiversus><span class="stackoverflow icon hidden-xs"></span><span class="hidden-sm hidden-md hidden-lg">Stack Overflow</span></a></li> <li><a href=https://github.com/semiversus data-toggle=tooltip data-placement=bottom title=Github.com/Semiversus><span class="github icon hidden-xs"></span><span class="hidden-sm hidden-md hidden-lg">Github</span></a></li> <li><a href=https://www.semiversus.com/semiversus.atom.xml class=rss data-toggle=tooltip data-placement=bottom title="RSS Feed"><span class="rss icon hidden-xs"></span><span class="hidden-sm hidden-md hidden-lg">RSS Feed</span></a></li> </ul> </div> </div> </nav> <div class=container> <div class=visible-print-block>Semiversus | VHDL Test (1)</div> <ol class="breadcrumb hidden-print"><li><a href=https://www.semiversus.com/dic/uebersicht.html>Unterrichtsmaterial</a></li><li><a href=https://www.semiversus.com/dic/programmierbare_logik/uebersicht.html>Programmierbare Logik</a></li><li><a href=https://www.semiversus.com/dic/programmierbare_logik/test_vhdl/uebersicht.html>Test - VHDL</a></li><li><strong>VHDL Test (1)</strong></li></ol> <div class=row> <div class=col-md-8 role=main> <header><h1>VHDL Test (1)<div class="pull-right hidden-print"><a href=https://www.semiversus.com/dic/programmierbare_logik/test_vhdl/test1.md class="btn btn-default btn-xs" data-toggle=tooltip data-placement=bottom title="Quelltext zu dieser Seite">Quelltext</a></div></h1></header> <h2 id=allgemeines>Allgemeines</h2> <ul> <li><a class=download href=https://www.semiversus.com/dic/programmierbare_logik/test_vhdl/vhdl_test_1.zip>Projektordner</a> herunterladen und entpacken</li> <li>Insgesamt gibt es <span class=badge>29 Punkte</span></li> <li>Die einzelnen Punkte bauen meist nicht aufeinander auf. Statt langer Fehlersuche lieber auf das n&auml;chste Beispiel wechseln.</li> </ul> <h2 id=lichtsteuerung>Lichtsteuerung</h2> <h3 id=vorbereitung>Vorbereitung</h3> <ul> <li>Projekt <samp>led_control/led_control.xise</samp> &ouml;ffnen</li> </ul> <h3 id=aufgabenstellung>Aufgabenstellung</h3> <p>Es ist eine einfache Lichtsteuerung zu entwerfen. Diese Lichtsteuerung steuert eine LED an und wird mittels zwei Tasten bedient:</p> <ul> <li><code>button_toggle</code> - Schaltet das Licht ein bzw. aus</li> <li><code>button_off</code> - Schaltet das Licht in 5 Sekunden aus</li> </ul> <h3 id=entwurf-der-zustandsmaschine>Entwurf der Zustandsmaschine</h3> <p><span class=badge>5 Punkte</span></p> <p>Zur Realisierung wird eine Zustandsmaschine genutzt.</p> <ul> <li>Bearbeite die Datei <samp>led_control_fsm.vhd</samp></li> <li>Definiere die drei Zust&auml;nden <code>OFF</code>, <code>LIGHT</code> und <code>DOZE</code></li> <li>Der Startzustand ist <code>OFF</code></li> <li>Der Eingang <code>toggle_i</code> wechselt von <code>OFF</code> nach <code>LIGHT</code> bzw. von <code>LIGHT</code> oder <code>DOZE</code> nach <code>OFF</code></li> <li>Der Eingang <code>off_i</code> wechselt von <code>LIGHT</code> nach <code>DOZE</code>, bei den anderen Zust&auml;nden hat er keine Auswirkung</li> <li>Der Eingang <code>timeout_i</code> bewirkt ein Wechsel von <code>DOZE</code> nach <code>OFF</code>, bei den anderen Zust&auml;nden hat er keine Auswirkung</li> <li>Der Ausgang <code>led_o</code> ist auf <code>'1'</code>, wenn die Zustandmaschine im Zustand <code>LIGHT</code> oder <code>DOZE</code> ist</li> <li>Der Ausgang <code>timer_enable_o</code> ist im Zustand <code>DOZE</code> auf <code>'1'</code>, ansonsten <code>'0'</code></li> <li>Der Ausgang <code>timer_clear_o</code> ist im Zustand <code>LIGHT</code> auf <code>'1'</code>, ansonsten <code>'0'</code></li> </ul> <p><img alt="FSM für Lichtsteuerung" src=https://www.semiversus.com/dic/programmierbare_logik/test_vhdl/test1_led_control_fsm.svg></p> <div class="panel panel-info"> <div class=panel-heading>Testbench</div> <div class=panel-body> <p>Teste die Implementierung mittels der Testbench <samp>led_control_fsm_tb.vhd</samp>. Mittels <kbd>F6</kbd> l&auml;sst sich der gesamte Bereich zoomen.</p> </div> </div> <h3 id=implementierung-des-top-levels>Implementierung des Top Levels</h3> <p><span class=badge>5 Punkte</span></p> <p>Zur Verf&uuml;gung stehen die Komponenten <samp>counter</samp>, <samp>button_dectect</samp> und <samp>led_control_fsm</samp>. Diese Komponenten werden genutzt, um im Top Level <samp>led_control.vhd</samp> die gew&uuml;nschte Funktionalit&auml;t zu realisieren.</p> <ul> <li>Die Instanz der Komponente <samp>button_detect</samp> mit dem Namen <code>toggle_detect_component</code> ist bereits erstellt<ul> <li><code>button_i</code> ist mit dem Eingang <code>button_toggle_i</code> verbunden</li> <li><code>detect_o</code> ist mit dem (bereits definiertem) Signal <code>toggle_detect</code> verbunden</li> </ul> </li> <li>Erstelle eine Instanz der Komponente <samp>button_detect</samp> mit dem Namen <code>off_detect_component</code> analog zu <code>toggle_detect_component</code><ul> <li><code>button_i</code> ist mit dem Eingang <code>button_off_i</code> verbunden</li> <li><code>detect_o</code> ist mit dem (bereits definiertem) Signal <code>off_detect</code> verbunden</li> </ul> </li> <li>Erstelle eine Instanz der Komponente <samp>led_control_fsm</samp> mit dem Namen <code>led_control_fsm_component</code><ul> <li><code>toggle_i</code> ist mit dem Signal <code>toggle_detect</code> verbunden</li> <li><code>off_i</code> ist mit dem Signal <code>off_detect</code> verbunden</li> <li><code>timeout_i</code> ist mit dem (bereits definiertem) Signal <code>timeout</code> verbunden</li> <li><code>led_o</code> ist mit dem Ausgang <code>led_o</code> verbunden</li> <li><code>timer_enable_o</code> ist mit dem (bereits definiertem) Signal <code>timer_enable</code> verbunden</li> <li><code>timer_clear_o</code> ist mit dem (bereits definiertem) Signal <code>timer_clear</code> verbunden</li> </ul> </li> <li>Erstelle eine Instanz der Komponente <samp>counter</samp> mit dem Namen <code>timeout_component</code><ul> <li><code>WIDTH</code> in der <em>generic map</em> wird auf 28 gestellt (28 Bit)</li> <li><code>MAXIMUM</code> wird auf <code>CLK_TIMEOUT_DIVIDER</code> gestellt (ist im <em>generic</em> Teil des Top Levels bereits definiert)</li> <li><code>enable_i</code> ist mit dem Signal <code>timer_enable</code> verbunden</li> <li><code>reset_i</code> ist mit dem Signal <code>timer_clear</code> verbunden</li> <li><code>value_o</code> ist nicht verbunden (<code>open</code>)</li> <li><code>overflow_o</code> ist mit dem Signal <code>timeout</code> verbunden</li> </ul> </li> <li>Jede Komponente hat einen Takteingang <code>clk</code>, welcher mit dem globalen <code>clk</code> verbunden wird</li> </ul> <div class="panel panel-info"> <div class=panel-heading>Testbench</div> <div class=panel-body> <p>Teste die Implementierung mittels der Testbench <samp>led_control_tb.vhd</samp>.</p> </div> </div> <h3 id=erweiterung-der-constraints-datei>Erweiterung der <em>Constraints</em> Datei</h3> <p><span class=badge>2 Punkte</span></p> <p>In der Datei <samp>led_control.ucf</samp> ist nur das Signal <code>clk</code> definiert. Erweitere die Datei um folgende Zuordnungen</p> <ul> <li><code>button_toggle_i</code> liegt an Pin <code>G12</code></li> <li><code>button_off_i</code> liegt an Pin <code>C11</code></li> <li><code>led_o</code> liegt an Pin <code>M5</code></li> </ul> <h3 id=test-am-board>Test am Board</h3> <p><span class=badge>1 Punkt</span></p> <p>Synthetisiere das Projekt und teste das Ergebnis am Board</p> <h2 id=helligkeitssteuerung-mittels-pwm_1>Helligkeitssteuerung mittels PWM</h2> <h3 id=vorbereitung_1>Vorbereitung</h3> <ul> <li>Projekt <samp>led_pwm/led_pwm.xise</samp> &ouml;ffnen</li> </ul> <h3 id=aufgabenstellung_1>Aufgabenstellung</h3> <p>Die LED wird in diesem Beispiel mittels PWM angesteuert. Zwei Tasten steuern dabei die Helligkeit:</p> <ul> <li><code>button_brighter</code> l&auml;sst die LED heller leuchten</li> <li><code>button_darker</code> l&auml;sst die LED dunkler leuchten</li> </ul> <p>Insgesamt gibt es 8 Helligkeitsstufen (3 Bit).</p> <h3 id=pwm-erzeugung>PWM Erzeugung</h3> <p><span class=badge>5 Punkte</span></p> <p>Ein PWM besteht aus einem Z&auml;hler, der st&auml;ndig nach oben z&auml;hlt. Bei einem &Uuml;berlauf (im Bild mit <em>N2</em> beschrieben) f&auml;ngt der Z&auml;hler einfach bei 0 wieder an. Der Z&auml;hlerstand wird verglichen mit einem vorgegebenen Pegel(<em>N1</em>) - sind diese gleich wird der Ausgang auf '0' gesetzt. Bei einem Z&auml;hlerstand von 0 wird der Ausgang auf '1' gesetzt (es sei den der vorgegebene Pegel ist 0).</p> <figure><img src=https://www.semiversus.com/dic/programmierbare_logik/test_vhdl/test1_pwm.svg><figcaption>PWM Signalerzeugung (Bild: <a href=https://commons.wikimedia.org/wiki/File:DMT_Messung-PuBrei.svg>Saure</a> CC BY-SA 3.0)</figcaption></figure> <ul> <li>Bearbeite die Datei <samp>pwm_generator.vhd</samp>.</li> <li>Der interne Z&auml;hler <code>counter_reg</code> z&auml;hlt bei jeder steigenden Taktflanke nach oben</li> <li>Der &Uuml;berlauf wird bewusst genutzt (es findet keine besondere &Uuml;berpr&uuml;fung statt)</li> <li>Der interne Z&auml;hler wird mit <code>level_i</code> verglichen - sind beide gleich wird <code>pwm_reg</code> auf <code>'0'</code> gesetzt</li> <li>Der interne Z&auml;hler wird weiters mit 0 verglichen - ist dies der Fall wird <code>pwm_reg</code> auf <code>'1'</code> gesetzt</li> <li>F&uuml;r die Umwandlung des <samp>std_ulogic_vector</samp> <code>level_i</code> in ein <samp>unsigned</samp> verwende <code>unsigned(level_i)</code></li> <li>F&uuml;r den Vergleich des internen Z&auml;hlers mit 0 wandle die 0 mittels <code>to_unsigned(0, WIDTH)</code> in ein <samp>unsigned</samp> um</li> <li>Der Ausgang <code>pwm_o</code> wird vom Registers <code>pwm_reg</code> angesteuert</li> </ul> <p><img alt="Blockschaltbild für PWM Erzeugung" src=https://www.semiversus.com/dic/programmierbare_logik/test_vhdl/test1_pwm_generator.jpg></p> <div class="panel panel-info"> <div class=panel-heading>Testbench</div> <div class=panel-body> <p>Teste die Implementierung mittels der Testbench <samp>pwm_generator_tb.vhd</samp>.</p> </div> </div> <h3 id=helligkeitseinstellung>Helligkeitseinstellung</h3> <p><span class=badge>5 Punkte</span></p> <p>Um einen Pegel f&uuml;r die PWM vorzugeben ben&ouml;tigen wir eine Komponente den einen Pegel abh&auml;ngig von Tastendr&uuml;cken &auml;ndern kann. Diese Komponente hat folgende Eing&auml;nge:</p> <ul> <li><code>up_i</code> - Wenn dieser Eingang gleich <code>'1'</code> ist wird der Pegel um eins erh&ouml;ht. Ist der Pegel auf Maximum wird nichts ge&auml;ndert.</li> <li><code>down_i</code> - Bei aktivem <code>down_i</code> wird der Pegel um eins erniedrigt. Ist der Pegel auf 0 wird nichts ge&auml;ndert.</li> </ul> <p>Die Ausgabe der Komponente ist der Ausgang <code>level_o</code>.</p> <ul> <li>Bearbeite die Datei <samp>level_adjust.vhd</samp>.</li> <li>Der Register <code>level_reg</code> z&auml;hlt hinauf, wenn <code>up_i</code> gleich <code>'1'</code> ist bzw. hinunter wenn <code>down_i</code> gleich <code>'1'</code> ist</li> <li>Wenn <code>level_reg</code> am Maximum ist und <code>up_i</code> aktiv ist sollte der Wert sich nicht ver&auml;ndern</li> <li>Wenn <code>level_reg</code> am Minimum (0) ist und <code>down_i</code> aktiv ist sollte der Wert sich nicht ver&auml;ndern</li> </ul> <div class="panel panel-info"> <div class=panel-heading>Testbench</div> <div class=panel-body> <p>Teste die Implementierung mittels der Testbench <samp>level_adjust_tb.vhd</samp>.</p> </div> </div> <h3 id=implementierung-des-top-levels_1>Implementierung des Top Levels</h3> <p><span class=badge>5 Punkte</span></p> <p>Zur Verf&uuml;gung stehen die Komponenten <samp>button_dectect</samp>, <samp>pwm_generator</samp> und <samp>level_adjust</samp>. Diese Komponenten werden genutzt, um im Top Level <samp>led_pwm.vhd</samp> die gew&uuml;nschte Funktionalit&auml;t zu realisieren.</p> <p>Das <em>Generic</em> <code>PWM_WIDTH</code> ist eine Konstante die genutzt werden kann, um das Generic <code>WIDTH</code> von <samp>pwm_generator</samp> und <samp>level_adjust</samp> zu setzen. Das bei diesen 3 die Default Einstellung ist, wird es nicht unbedingt ben&ouml;tigt.</p> <p>Einige ben&ouml;tigte Signale sind bereits vordefiniert.</p> <p>Erstelle das Top Level anhand des folgenden Blockschaltbildes:</p> <p><img alt="Top Level für LED PWM" src=https://www.semiversus.com/dic/programmierbare_logik/test_vhdl/test1_led_pwm.jpg></p> <div class="panel panel-info"> <div class=panel-heading>Testbench</div> <div class=panel-body> <p>Teste die Implementierung mittels der Testbench <samp>led_pwm_tb.vhd</samp>.</p> </div> </div> <h3 id=test-am-board_1>Test am Board</h3> <p><span class=badge>1 Punkt</span></p> <p>Synthetisiere das Projekt und teste das Ergebnis am Board</p> </div> <div class=col-md-4 role=complementary> <nav class="well well-sm" data-spy=affix data-offset-top=0 id=sidebar> <ul class=nav><li><a href=#allgemeines>Allgemeines</a></li><li><a href=#lichtsteuerung>Lichtsteuerung</a><ul class=nav><li><a href=#vorbereitung>Vorbereitung</a></li><li><a href=#aufgabenstellung>Aufgabenstellung</a></li><li><a href=#entwurf-der-zustandsmaschine>Entwurf der Zustandsmaschine</a></li><li><a href=#implementierung-des-top-levels>Implementierung des Top Levels</a></li><li><a href=#erweiterung-der-constraints-datei>Erweiterung der Constraints Datei</a></li><li><a href=#test-am-board>Test am Board</a></li></ul></li><li><a href=#helligkeitssteuerung-mittels-pwm_1>Helligkeitssteuerung mittels PWM</a><ul class=nav><li><a href=#vorbereitung_1>Vorbereitung</a></li><li><a href=#aufgabenstellung_1>Aufgabenstellung</a></li><li><a href=#pwm-erzeugung>PWM Erzeugung</a></li><li><a href=#helligkeitseinstellung>Helligkeitseinstellung</a></li><li><a href=#implementierung-des-top-levels_1>Implementierung des Top Levels</a></li><li><a href=#test-am-board_1>Test am Board</a></li></ul></li></ul> </nav> </div> </div> </div> </div> <footer class="footer hidden-print"><div class=container><p class="text-muted credit">Günther Jena 2011 - 2020 | Letztes Update am 20.9.2020 (Rev. <a href=https://github.com/semiversus/semiversus.github.io-source/commit/ffdbb85>ffdbb85</a>) <a href=https://plus.google.com/111972313670421914746/about rel=author class=hidden>Google+</a><a href=https://creativecommons.org/licenses/by-sa/3.0/de/ class=pull-right><img src=https://www.semiversus.com/theme/img/cc_by_sa.svg alt="Licence CC-BY-SA"></a></p></div></footer> <script type=text/javascript>
        var s = document.createElement('script');
        s.type = 'text/javascript';
        s.src = 'https:' == document.location.protocol ? 'https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML' : 'http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; 
        s[(window.opera ? "innerHTML" : "text")] =
            "MathJax.Hub.Config({" + 
            "    config: ['MMLorHTML.js']," + 
            "    jax: ['input/TeX','input/MathML','output/HTML-CSS','output/NativeMML']," +
            "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," + 
            "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
            "    tex2jax: { " +
            "        inlineMath: [ ['%%','%%'] ], " +
            "        processEscapes: false }, " +
            "    'HTML-CSS': { " +
            "        styles: { '.MathJax .mo, .MathJax .mi': {color: 'black ! important'}} " +
            "    } " +
            "}); ";
        (document.body || document.getElementsByTagName('head')[0]).appendChild(s);
    </script> </body> </html>