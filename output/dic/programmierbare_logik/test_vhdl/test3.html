<!DOCTYPE html><html lang=de> <head><title>VHDL Test (3)</title><link rel=icon href=https://www.semiversus.com/favicon.ico><meta charset=utf-8><meta name=description content="Allgemeines Projektordner herunterladen und entpacken Insgesamt gibt es 29 Punkte Die einzelnen Punkte bauen meist nicht aufeinander auf. Statt langer Fehlersuche lieber auf das nächste Beispiel wechseln. Einschaltverzögerung Vorbereitung Projekt led_toggle/led_toggle.xise öffnen Aufgabenstellung Zwei LEDs sollen mittels zwei Taster angesteuert werden. button_toggle - Wechselt zwischen LED1 und ..."><meta name=author content="Günther Jena"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=google-site-verification content=O-3LVEziPiVrCYqFCwbLmB3s7lNG__cPMLLAr_RUxbA><meta name=msvalidate.01 content=70DFF0E672B42811AA384CC455C9406C><link rel=stylesheet href=https://www.semiversus.com/theme/css/semiversus.min.css?f7108c59><script async src=https://www.semiversus.com/theme/js/semiversus.min.js?c02fe949></script></head> <body data-spy=scroll data-target=#sidebar data-offset=30> <div id=wrap> <nav class="navbar navbar-inverse"> <div class=container> <div class=navbar-header> <button type=button class="navbar-toggle collapsed" data-toggle=collapse data-target=.navbar-collapse> <span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span> </button> <a href=https://www.semiversus.com/index.html class=navbar-brand>SEMIVERSUS</a> </div> <div class="navbar-collapse collapse"> <ul class="nav navbar-nav"> <li><a href=https://www.semiversus.com/index.html>Blog</a></li> <li><a href=https://www.semiversus.com/dic/uebersicht.html>Unterricht</a></li> <li><a href=https://www.semiversus.com/projekte/projekte.html>Projekte</a></li> <li><a href=https://www.semiversus.com/about.html>Über mich</a></li> </ul> <form class="navbar-form navbar-right" role=search action=https://www.semiversus.com/search.html onsubmit="return validateForm(this.elements['q'].value);"> <input type=text class=form-control placeholder=Suche name=q id=tipue_search_input></form> <ul class="nav navbar-nav navbar-right socialicons"> <li><a href=https://www.linkedin.com/in/guenther-jena data-toggle=tooltip data-placement=bottom title=LinkedIn.com/Günther-Jena><span class="linkedin icon hidden-xs"></span><span class="hidden-sm hidden-md hidden-lg">Linkedin</span></a></li> <li><a href=https://www.xing.com/profile/Guenther_Jena2 data-toggle=tooltip data-placement=bottom title=Xing.com/Günther-Jena><span class="xing icon hidden-xs"></span><span class="hidden-sm hidden-md hidden-lg">Xing</span></a></li> <li><a href=https://stackoverflow.com/users/166605/g%C3%BCnther-jena data-toggle=tooltip data-placement=bottom title=Stackoverflow.com/Semiversus><span class="stackoverflow icon hidden-xs"></span><span class="hidden-sm hidden-md hidden-lg">Stack Overflow</span></a></li> <li><a href=https://github.com/semiversus data-toggle=tooltip data-placement=bottom title=Github.com/Semiversus><span class="github icon hidden-xs"></span><span class="hidden-sm hidden-md hidden-lg">Github</span></a></li> <li><a href=https://www.semiversus.com/semiversus.atom.xml class=rss data-toggle=tooltip data-placement=bottom title="RSS Feed"><span class="rss icon hidden-xs"></span><span class="hidden-sm hidden-md hidden-lg">RSS Feed</span></a></li> </ul> </div> </div> </nav> <div class=container> <div class=visible-print-block>Semiversus | VHDL Test (3)</div> <ol class="breadcrumb hidden-print"><li><a href=https://www.semiversus.com/dic/uebersicht.html>Unterrichtsmaterial</a></li><li><a href=https://www.semiversus.com/dic/programmierbare_logik/uebersicht.html>Programmierbare Logik</a></li><li><a href=https://www.semiversus.com/dic/programmierbare_logik/test_vhdl/uebersicht.html>Test - VHDL</a></li><li><strong>VHDL Test (3)</strong></li></ol> <div class=row> <div class=col-md-8 role=main> <header><h1>VHDL Test (3)<div class="pull-right hidden-print"><a href=https://www.semiversus.com/dic/programmierbare_logik/test_vhdl/test3.md class="btn btn-default btn-xs" data-toggle=tooltip data-placement=bottom title="Quelltext zu dieser Seite">Quelltext</a></div></h1></header> <h2 id=allgemeines>Allgemeines</h2> <ul> <li><a class=download href=https://www.semiversus.com/dic/programmierbare_logik/test_vhdl/vhdl_test_3.zip>Projektordner</a> herunterladen und entpacken</li> <li>Insgesamt gibt es <span class=badge>29 Punkte</span></li> <li>Die einzelnen Punkte bauen meist nicht aufeinander auf. Statt langer Fehlersuche lieber auf das n&auml;chste Beispiel wechseln.</li> </ul> <h2 id=einschaltverzogerung>Einschaltverz&ouml;gerung</h2> <h3 id=vorbereitung>Vorbereitung</h3> <ul> <li>Projekt <samp>led_toggle/led_toggle.xise</samp> &ouml;ffnen</li> </ul> <h3 id=aufgabenstellung>Aufgabenstellung</h3> <p>Zwei LEDs sollen mittels zwei Taster angesteuert werden.</p> <ul> <li><code>button_toggle</code> - Wechselt zwischen LED1 und LED2, bzw. schaltet LED1 ein, falls die LEDs ausgeschaltet waren.</li> <li><code>button_off</code> - Schaltet die LEDs aus</li> </ul> <h3 id=entwurf-der-zustandsmaschine>Entwurf der Zustandsmaschine</h3> <p><span class=badge>5 Punkte</span></p> <p>Zur Realisierung wird eine Zustandsmaschine genutzt.</p> <ul> <li>Bearbeite die Datei <samp>led_toggle_fsm.vhd</samp></li> <li>Definiere die drei Zust&auml;nden <code>OFF</code>, <code>LED1</code> und <code>LED2</code></li> <li>Der Startzustand ist <code>OFF</code></li> <li>Der Eingang <code>toggle_i</code> wechselt von <code>OFF</code> nach <code>LED1</code> bzw. wechselt von <code>LED1</code> nach <code>LED2</code> und umgekehrt</li> <li>Der Eingang <code>off_i</code> wechselt immer in den Zustand <code>OFF</code></li> <li>Der Eingang <code>off_i</code> hat die h&ouml;here Priorit&auml;t als der Eingang <code>toggle_i</code></li> <li>Der Ausgang <code>led1_o</code> ist auf <code>'1'</code>, wenn die Zustandmaschine im Zustand <code>LED1</code> ist</li> <li>Der Ausgang <code>led2_o</code> ist auf <code>'1'</code>, wenn die Zustandmaschine im Zustand <code>LED2</code> ist</li> </ul> <div class="panel panel-info"> <div class=panel-heading>Testbench</div> <div class=panel-body> <p>Teste die Implementierung mittels der Testbench <samp>led_toggle_fsm_tb.vhd</samp>. Mittels <kbd>F6</kbd> l&auml;sst sich der gesamte Bereich zoomen.</p> </div> </div> <h3 id=implementierung-des-top-levels>Implementierung des Top Levels</h3> <p><span class=badge>5 Punkte</span></p> <p>Zur Verf&uuml;gung stehen die Komponenten <samp>button_dectect</samp> und <samp>led_toggle_fsm</samp>. Diese Komponenten werden genutzt, um im Top Level <samp>led_toggle.vhd</samp> die gew&uuml;nschte Funktionalit&auml;t zu realisieren.</p> <ul> <li>Die Instanz der Komponente <samp>button_detect</samp> mit dem Namen <code>toggle_detect_component</code> ist bereits erstellt<ul> <li><code>button_i</code> ist mit dem Eingang <code>button_toggle_i</code> verbunden</li> <li><code>detect_o</code> ist mit dem (bereits definiertem) Signal <code>toggle_detect</code> verbunden</li> </ul> </li> <li>Erstelle eine Instanz der Komponente <samp>button_detect</samp> mit dem Namen <code>off_detect_component</code> analog zu <code>toggle_detect_component</code><ul> <li><code>button_i</code> ist mit dem Eingang <code>button_off_i</code> verbunden</li> <li><code>detect_o</code> ist mit dem (bereits definiertem) Signal <code>off_detect</code> verbunden</li> </ul> </li> <li>Erstelle eine Instanz der Komponente <samp>led_toggle_fsm</samp> mit dem Namen <code>led_toggle_fsm_component</code><ul> <li><code>toggle_i</code> ist mit dem Signal <code>toggle_detect</code> verbunden</li> <li><code>off_i</code> ist mit dem Signal <code>off_detect</code> verbunden</li> <li><code>led1_o</code> ist mit dem Ausgang <code>led1_o</code> verbunden</li> <li><code>led2_o</code> ist mit dem Ausgang <code>led2_o</code> verbunden</li> </ul> </li> <li>Jede Komponente hat einen Takteingang <code>clk</code>, welcher mit dem globalen <code>clk</code> verbunden wird</li> </ul> <div class="panel panel-info"> <div class=panel-heading>Testbench</div> <div class=panel-body> <p>Teste die Implementierung mittels der Testbench <samp>led_toggle_tb.vhd</samp>.</p> </div> </div> <h3 id=erweiterung-der-constraints-datei>Erweiterung der <em>Constraints</em> Datei</h3> <p><span class=badge>2 Punkte</span></p> <p>In der Datei <samp>led_toggle.ucf</samp> ist nur das Signal <code>clk</code> definiert. Erweitere die Datei um folgende Zuordnungen</p> <ul> <li><code>button_toggle_i</code> wird durch den Taster <samp>BTN0</samp> angesteuert</li> <li><code>button_off_i</code> wird durch den Taster <samp>BTN1</samp> angesteuert</li> <li><code>led1_o</code> ist die LED <samp>LD0</samp></li> <li><code>led2_o</code> ist die LED <samp>LD1</samp></li> </ul> <figure><img src=https://www.semiversus.com/dic/programmierbare_logik/basys2_pinout.svg><figcaption>Pinout des BASYS2 Boards(Bild: <a href="http://www.digilentinc.com/Products/Detail.cfm?NavPath=2,400,790&Prod=BASYS2">Digilent Inc. BASYS2 Manual</a>)</figcaption></figure> <h3 id=test-am-board>Test am Board</h3> <p><span class=badge>1 Punkt</span></p> <p>Synthetisiere das Projekt und teste das Ergebnis am Board</p> <h2 id=ampel-mit-uberwachung_1>Ampel mit &Uuml;berwachung</h2> <h3 id=vorbereitung_1>Vorbereitung</h3> <ul> <li>Projekt <samp>lights/lights.xise</samp> &ouml;ffnen</li> </ul> <h3 id=aufgabenstellung_1>Aufgabenstellung</h3> <p>Es soll eine Ampel mit zwei Modis realisiert werden:</p> <ul> <li>Orange-Blinken (Orange Leuchte geht ein und aus)</li> <li>Wechsel zwischen Gr&uuml;n, Orange, Rot, Rot-Orange und wieder Gr&uuml;n</li> </ul> <p>Die Ausg&auml;nge f&uuml;r die drei Farben der Ampel werden mittels drei Bit Vektor dargestellt:</p> <ul> <li>Bit0 (ganz rechts) entspricht der gr&uuml;nen Leuchte</li> <li>Bit1 entspricht der orangen Leuchte</li> <li>Bit2 (ganz links) entspricht der roten Leuchte.</li> </ul> <p>So steht z.B. <code>"110"</code> f&uuml;r eine Ampel, bei der Rot und Orange leuchtet. Bei <code>OFF</code> soll nichts leuchten.</p> <p>Zus&auml;tzlich soll eine <em>&Uuml;berwachung</em> vorhanden sein, die feststellt, ob es zu ung&uuml;ltigen Kombinationen gekommen ist (z.B. wenn Rot und Gr&uuml;n gleichzeitig leuchten). Die &Uuml;berwachung w&uuml;rde in diesem Fall die Ampel Rot leuchten lassen.</p> <h3 id=uberwachung>&Uuml;berwachung</h3> <p><span class=badge>5 Punkte</span></p> <p>Die Komponente <code>supervisor</code> (deutsch <em>&Uuml;berwacher</em>) soll die Zust&auml;nde der drei Lampen &uuml;berpr&uuml;fen. Dazu hat die Komponente den Eingang <code>monitor_i</code> und den Ausgang <code>result_o</code>.</p> <ul> <li>Liegt an <code>monitor_i</code> eine g&uuml;ltige Kombination an (z.B. <code>"001"</code> f&uuml;r Gr&uuml;n) soll diese Kombination am Ausgang <code>result_o</code> erscheinen</li> <li>Liegt eine ung&uuml;ltige Kombination an (z.B. <code>"101"</code>) soll stattdessen die Kombination f&uuml;r Rot ausgegeben werden (<code>"100"</code>)</li> <li>G&uuml;ltige Kombinationen sind alle Ausgaben der Zust&auml;nde <code>GREEN</code>, <code>ORANGE</code>, <code>RED</code>, <code>RED_ORANGE</code> und <code>OFF</code></li> </ul> <p>Die Komponente ist in vier Ausf&uuml;hrungen (<em>Architectures</em>) bereits in der Datei <samp>supervisor.vhd</samp> beschrieben. Die <em>Architectures</em> lauten <code>behave1</code>, <code>behave2</code>, <code>behave3</code> und <code>behave4</code>.</p> <p>Erstelle in der Datei <samp>supervisor_tb.vhd</samp> eine Testbench, die herausfindet, welche der vier Ausf&uuml;hrungen funktioniert (es ist genau eine).</p> <h3 id=komponente-lights_fsm>Komponente <code>lights_fsm</code></h3> <p><span class=badge>5 Punkte</span></p> <p>Erstelle die Komponente <code>lights_fsm</code> durch Bearbeitung der Datei <samp>lights_fsm.vhd</samp>.</p> <ul> <li>Die Ampel wechselt nur den Zustand, wenn <code>next_i</code> gleich <code>'1'</code> ist</li> <li>Ist der Eingang <code>mode_i</code> gleich <code>'0'</code> soll die Ampel zwischen den Zust&auml;nden <code>ORANGE</code> und <code>OFF</code> wechseln</li> <li>Bei <code>mode_i</code> gleich <code>'1'</code> soll die Ampel zyklisch zwischen <code>GREEN</code>, <code>ORANGE</code>, <code>RED</code>, <code>RED_ORANGE</code> wechseln und anschlie&szlig;end bei <code>GREEN</code> wieder starten</li> <li>Ist die Ampel im Zustand <code>GREEN</code>, <code>RED</code> oder <code>RED_ORANGE</code> und <code>mode_i</code> ist <code>'0'</code> soll der n&auml;chste Zustand <code>ORANGE</code> sein</li> <li>Ist die Ampel im Zustand <code>OFF</code> und <code>mode_i</code> ist <code>'1'</code> soll der n&auml;chste Zustand <code>ORANGE</code> sein</li> <li>Der Startzustand ist <code>ORANGE</code></li> </ul> <div class="panel panel-info"> <div class=panel-heading>Testbench</div> <div class=panel-body> <p>Teste die Implementierung mittels der Testbench <samp>lights_fsm_tb.vhd</samp>.</p> </div> </div> <h3 id=implementierung-des-top-levels_1>Implementierung des Top Levels</h3> <p><span class=badge>5 Punkte</span></p> <p>Zur Verf&uuml;gung stehen die Komponenten <samp>counter</samp>, <samp>light_fsm</samp> und <samp>supervisor</samp>. Diese Komponenten werden genutzt, um im Top Level <samp>lights.vhd</samp> die gew&uuml;nschte Funktionalit&auml;t zu realisieren.</p> <p>Mit dem <samp>counter</samp> soll ein 700 Millisekunden Takt generiert werden. Wieviel Takte des 50 Mhz Taktes sind dazu notwendig und wieviel Bits werden ben&ouml;tigt, um diesen Wert darstellen zu k&ouml;nnen? Trage diese Werte in der Default-Einstellung von <code>COUNTER_WIDTH</code> und <code>COUNTER_MAXIMUM</code> ein:</p> <div class=codehilite><pre><span></span><span class=k>entity</span> <span class=nc>lights</span> <span class=k>is</span>
  <span class=k>generic</span> <span class=p>(</span>
    <span class=n>COUNTER_WIDTH</span> <span class=o>:</span> <span class=kt>integer</span> <span class=o>:=</span> <span class=mi>4</span><span class=p>;</span> <span class=c1>-- &lt;&lt;&lt; TODO</span>
    <span class=n>COUNTER_MAXIMUM</span> <span class=o>:</span> <span class=kt>integer</span> <span class=o>:=</span> <span class=mi>9</span> <span class=c1>-- &lt;&lt;&lt; TODO</span>
  <span class=p>);</span>
  <span class=k>port</span> <span class=p>(</span>
    <span class=n>clk</span> <span class=o>:</span> <span class=k>in</span> <span class=kt>std_ulogic</span><span class=p>;</span> <span class=c1>-- 50 MHz clock</span>
    <span class=n>mode_i</span> <span class=o>:</span> <span class=k>in</span> <span class=kt>std_ulogic</span><span class=p>;</span>
    <span class=n>leds_o</span> <span class=o>:</span> <span class=k>out</span> <span class=kt>std_ulogic_vector</span><span class=p>(</span><span class=mi>2</span> <span class=k>downto</span> <span class=mi>0</span><span class=p>)</span>
  <span class=p>);</span>
<span class=k>end</span> <span class=k>entity</span><span class=p>;</span>
</pre></div> <p>Erstelle das Top Level anhand des folgenden Blockschaltbildes:</p> <p><img alt="Top Level für Lights" src=https://www.semiversus.com/dic/programmierbare_logik/test_vhdl/test3_lights.jpg></p> <p>Gegebenenfalls m&uuml;ssen noch Signale definiert werden.</p> <div class="panel panel-info"> <div class=panel-heading>Testbench</div> <div class=panel-body> <p>Teste die Implementierung mittels der Testbench <samp>lights_tb.vhd</samp>.</p> </div> </div> <h3 id=test-am-board_1>Test am Board</h3> <p><span class=badge>1 Punkt</span></p> <p>Synthetisiere das Projekt und teste das Ergebnis am Board</p> </div> <div class=col-md-4 role=complementary> <nav class="well well-sm" data-spy=affix data-offset-top=0 id=sidebar> <ul class=nav><li><a href=#allgemeines>Allgemeines</a></li><li><a href=#einschaltverzogerung>Einschaltverz&ouml;gerung</a><ul class=nav><li><a href=#vorbereitung>Vorbereitung</a></li><li><a href=#aufgabenstellung>Aufgabenstellung</a></li><li><a href=#entwurf-der-zustandsmaschine>Entwurf der Zustandsmaschine</a></li><li><a href=#implementierung-des-top-levels>Implementierung des Top Levels</a></li><li><a href=#erweiterung-der-constraints-datei>Erweiterung der Constraints Datei</a></li><li><a href=#test-am-board>Test am Board</a></li></ul></li><li><a href=#ampel-mit-uberwachung_1>Ampel mit &Uuml;berwachung</a><ul class=nav><li><a href=#vorbereitung_1>Vorbereitung</a></li><li><a href=#aufgabenstellung_1>Aufgabenstellung</a></li><li><a href=#uberwachung>&Uuml;berwachung</a></li><li><a href=#komponente-lights_fsm>Komponente lights_fsm</a></li><li><a href=#implementierung-des-top-levels_1>Implementierung des Top Levels</a></li><li><a href=#test-am-board_1>Test am Board</a></li></ul></li></ul> </nav> </div> </div> </div> </div> <footer class="footer hidden-print"><div class=container><p class="text-muted credit">Günther Jena 2011 - 2020 | Letztes Update am 20.9.2020 (Rev. <a href=https://github.com/semiversus/semiversus.github.io-source/commit/ffdbb85>ffdbb85</a>) <a href=https://plus.google.com/111972313670421914746/about rel=author class=hidden>Google+</a><a href=https://creativecommons.org/licenses/by-sa/3.0/de/ class=pull-right><img src=https://www.semiversus.com/theme/img/cc_by_sa.svg alt="Licence CC-BY-SA"></a></p></div></footer> <script type=text/javascript>
        var s = document.createElement('script');
        s.type = 'text/javascript';
        s.src = 'https:' == document.location.protocol ? 'https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML' : 'http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; 
        s[(window.opera ? "innerHTML" : "text")] =
            "MathJax.Hub.Config({" + 
            "    config: ['MMLorHTML.js']," + 
            "    jax: ['input/TeX','input/MathML','output/HTML-CSS','output/NativeMML']," +
            "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," + 
            "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
            "    tex2jax: { " +
            "        inlineMath: [ ['%%','%%'] ], " +
            "        processEscapes: false }, " +
            "    'HTML-CSS': { " +
            "        styles: { '.MathJax .mo, .MathJax .mi': {color: 'black ! important'}} " +
            "    } " +
            "}); ";
        (document.body || document.getElementsByTagName('head')[0]).appendChild(s);
    </script> </body> </html>